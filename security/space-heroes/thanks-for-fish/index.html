<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
        <meta content="text/html; charset=UTF-8" http-equiv="content-type"/>
        <meta content="width=device-width, initial-scale=1" name="viewport"/>

        
        
        

        

        

        

        
        
        

        <title>Thanks for all the Fish</title>
        
        <meta name="title" content="Thanks for all the Fish">
        
        
        <meta name="generator" content="Zola v0.16.1">

        <meta property="og:type" content="website">
        <meta property="og:url" content="https://vaughn.sh/security/space-heroes/thanks-for-fish/">
        <meta property="og:site_name" content="">
        <meta property="og:title" content="Thanks for all the Fish">
        
        

        
        
        <meta property="twitter:card" content="summary_large_image">
        <meta property="twitter:url" content="https://vaughn.sh/security/space-heroes/thanks-for-fish/">
        <meta property="twitter:title" content="Thanks for all the Fish">
        
        
        
        
        <link rel="canonical" href="https://vaughn.sh/security/space-heroes/thanks-for-fish/">
        
        <script type="application/ld+json">
            {
                
                "url":"https://vaughn.sh/security/space-heroes/thanks-for-fish/",
                "@type":"WebSite",
                "headline":"Thanks for all the Fish",
                "name":"Thanks for all the Fish",
                
                "@context":"https://schema.org"
            }
        </script>
        
        
        
        <link rel="stylesheet" href="https://vaughn.sh/style.css"/>
        
    </head>
    <body theme="auto">
        <div class="w">
            <header>
                
                <nav>
                    
                    <a href="/" >@home</a>
                    
                    <a href="/recipes" >#recipes</a>
                    
                    <a href="/security" >+security</a>
                    
                    <a href="/hobbies" >$hobbies</a>
                    
                    <a href="https://github.com/vaughnw128" >~github</a>
                    
                    <a href="https://sbcord.com" >!friends</a>
                    
                </nav>
                
                
<p><a href="..">..</a>/thanks-for-fish</p>
<p class="post-meta"><time datetime=""></time></p>
<h1>Thanks for all the Fish</h1>

            </header>
            <main class="page-content" aria-label="Content">
                



<p><strong>Category:</strong> Reversing
<strong>Points:</strong> ???
<strong>Solved By:</strong> Apicius</p>
<h2 id="challenge">Challenge</h2>
<blockquote>
<p><em>Welcome, human, to the 42nd centennial dolphin acrobatics show! Better get to it. These dolphins aren't going to train themselves...</em>*</p>
<p><em>Author: Curt√≠co</em></p>
</blockquote>
<p>Files: <code>thanks4allthefish (ELF Binary)</code></p>
<h2 id="solution">Solution</h2>
<p>I'm personally a big fan of the Hitchhikers Guide to the Galaxy series, so I'm happy to see a challenge like this.</p>
<p><img src="https://vaughn.sh/security/space-heroes/thanks-for-fish/hitchhikersguidetothegalaxy-dolphin.gif" alt="" /></p>
<p><img src="https://vaughn.sh/security/space-heroes/thanks-for-fish/dolphins1.png" alt="" /></p>
<p>Running the program ends up just causing it to exit again, likely because the conditions to get the flag have not been fulfilled. Opening it in Ghidra, we can see some of these conditions.</p>
<p><img src="https://vaughn.sh/security/space-heroes/thanks-for-fish/dolphinsmain.png" alt="" /></p>
<p>It seems to be checking what program is running it based on the <code>snprintf</code> statement checking <code>proc/getppid()/comm</code>. It doesn't like that it's being run by bash, and would rather be run by tidbits.</p>
<p>I wrote a quick bash script that just calls the binary. When we run it with tidbits, it then starts to do tricks! </p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#65737e;">#!/bin/bash
</span><span style="color:#bf616a;">./tidbits
</span></code></pre>
<p><img src="https://vaughn.sh/security/space-heroes/thanks-for-fish/dolphins2.png" alt="" /></p>
<p>It doesn't like that we ran out of tidbits for it, and we can see this in the code.</p>
<p><img src="https://vaughn.sh/security/space-heroes/thanks-for-fish/dolphinstreats.png" alt="" /></p>
<p>It wants to have 5 tidbits in /proc/*/comm. To get this, I simply wrote another script called tidbits with an infinite loop in it, and then ran <code>./tid/tidbits&amp;</code> four times, and then ran the script again. This then got us our flag, and showed us the most intelligent creature on the planet. Sucks to get only third place.</p>
<p><img src="https://vaughn.sh/security/space-heroes/thanks-for-fish/dolphins4.png" alt="" /></p>
<p><strong>Flag:</strong> <code>shctf{0k_but_h4v3_y0u_s33n_th3_m1c3}</code></p>


            </main>
            <footer>
                
<p class="taxonomies">

</p>

                
            </footer>
        </div>
    </body>
</html>
        
